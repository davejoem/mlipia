"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(e,t,s){this.mlipia=e,this.purview=t,this.events=[],this.register().then(()=>{1==s&&this.listen()})}add(){return new Promise((e,t)=>{})}listen(){this.events.forEach(e=>{let t=this.purview+":"+e.name;this.mlipia.socket.on(t,e.func)})}register(){return Promise.resolve(()=>{this.events.push({func:this.list,name:this.purview+":"+this.purview+":list"})})}stopListening(){return Promise.resolve(()=>{this.events.forEach(e=>{let t=this.purview+":"+e.name;this.mlipia.socket.off(t)})})}list(e){return new Promise((t,s)=>{this.mlipia.models.Client.find().exec().then(s=>{this.end(t,e,s)}).catch(t=>{this.end(s,e,{message:"Couldn't list clients.",error:t})})})}end(e,t,s){e(s),t(s)}}exports.ClientsEvents=e;