"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(e,s,t){this.mlipia=e,this.purview=s,this.events=[],this.register().then(()=>{1==t&&this.listen()})}listen(){this.events.forEach(e=>{let s=this.purview+":"+e.name;this.mlipia.socket.on(s,e.func)})}register(){return Promise.resolve(()=>{this.events.push({func:this.list,name:this.purview+":list"})})}stopListening(){return Promise.resolve(()=>{this.events.forEach(e=>{let s=this.purview+":"+e.name;this.mlipia.socket.off(s)})})}list(e){return new Promise((s,t)=>{this.mlipia.models.User.find().then(t=>{this.end(s,e,t)}).catch(s=>{this.end(t,e,{message:"Couldn't list users",error:s})})})}end(e,s,t){e(t),s(t)}}exports.UsersEvents=e;